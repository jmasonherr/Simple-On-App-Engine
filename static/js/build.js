function startPreview(){setInterval(function(){var e=$("article").first().attr("id");$.post("/preview/"+e,function(e){refreshPreview(e)})},15e3)}function startCode(){$("code").addClass("prettyprint"),$.getScript("/javascripts/prettify.js").done(function(e,t){var n="/stylesheets/prettify.css";$.get(n,function(e){$('<style type="text/css"></style>').html(e).appendTo("head")}),prettyPrint()})}function refreshPreview(e){cur_content=$(".content").html(),cur_title=$(".title").html(),cur_content!=e.content&&$(".content").html(e.content),cur_title!=e.title&&$(".title").html(e.title)}function flasher(){setTimeout(function(){$("div#error_explanation, div.error_explanation").slideDown(300)},500),$("ul.errors li, ul.errors li").click(function(e){return $(this).slideToggle(),e.preventDefault(),!1})}(function(e,t){var n;e.rails=n={linkClickSelector:"a[data-confirm], a[data-method], a[data-remote], a[data-disable-with]",inputChangeSelector:"select[data-remote], input[data-remote], textarea[data-remote]",formSubmitSelector:"form",formInputClickSelector:"form input[type=submit], form input[type=image], form button[type=submit], form button:not(button[type])",disableSelector:"input[data-disable-with], button[data-disable-with], textarea[data-disable-with]",enableSelector:"input[data-disable-with]:disabled, button[data-disable-with]:disabled, textarea[data-disable-with]:disabled",requiredInputSelector:"input[name][required]:not([disabled]),textarea[name][required]:not([disabled])",fileInputSelector:"input:file",linkDisableSelector:"a[data-disable-with]",CSRFProtection:function(t){var n=e('meta[name="csrf-token"]').attr("content");n&&t.setRequestHeader("X-CSRF-Token",n)},fire:function(t,n,r){var i=e.Event(n);return t.trigger(i,r),i.result!==!1},confirm:function(e){return confirm(e)},ajax:function(t){return e.ajax(t)},href:function(e){return e.attr("href")},handleRemote:function(r){var i,s,o,u,a,f;if(n.fire(r,"ajax:before")){u=r.data("cross-domain")||null,a=r.data("type")||e.ajaxSettings&&e.ajaxSettings.dataType;if(r.is("form")){i=r.attr("method"),s=r.attr("action"),o=r.serializeArray();var l=r.data("ujs:submit-button");l&&(o.push(l),r.data("ujs:submit-button",null))}else r.is(n.inputChangeSelector)?(i=r.data("method"),s=r.data("url"),o=r.serialize(),r.data("params")&&(o=o+"&"+r.data("params"))):(i=r.data("method"),s=n.href(r),o=r.data("params")||null);return f={type:i||"GET",data:o,dataType:a,crossDomain:u,beforeSend:function(e,i){return i.dataType===t&&e.setRequestHeader("accept","*/*;q=0.5, "+i.accepts.script),n.fire(r,"ajax:beforeSend",[e,i])},success:function(e,t,n){r.trigger("ajax:success",[e,t,n])},complete:function(e,t){r.trigger("ajax:complete",[e,t])},error:function(e,t,n){r.trigger("ajax:error",[e,t,n])}},s&&(f.url=s),n.ajax(f)}return!1},handleMethod:function(r){var i=n.href(r),s=r.data("method"),o=r.attr("target"),u=e("meta[name=csrf-token]").attr("content"),a=e("meta[name=csrf-param]").attr("content"),f=e('<form method="post" action="'+i+'"></form>'),l='<input name="_method" value="'+s+'" type="hidden" />';a!==t&&u!==t&&(l+='<input name="'+a+'" value="'+u+'" type="hidden" />'),o&&f.attr("target",o),f.hide().append(l).appendTo("body"),f.submit()},disableFormElements:function(t){t.find(n.disableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with",t[n]()),t[n](t.data("disable-with")),t.prop("disabled",!0)})},enableFormElements:function(t){t.find(n.enableSelector).each(function(){var t=e(this),n=t.is("button")?"html":"val";t.data("ujs:enable-with")&&t[n](t.data("ujs:enable-with")),t.prop("disabled",!1)})},allowAction:function(e){var t=e.data("confirm"),r=!1,i;return t?(n.fire(e,"confirm")&&(r=n.confirm(t),i=n.fire(e,"confirm:complete",[r])),r&&i):!0},blankInputs:function(t,n,r){var i=e(),s,o=n||"input,textarea";return t.find(o).each(function(){s=e(this);if(r?s.val():!s.val())i=i.add(s)}),i.length?i:!1},nonBlankInputs:function(e,t){return n.blankInputs(e,t,!0)},stopEverything:function(t){return e(t.target).trigger("ujs:everythingStopped"),t.stopImmediatePropagation(),!1},callFormSubmitBindings:function(n,r){var i=n.data("events"),s=!0;return i!==t&&i.submit!==t&&e.each(i.submit,function(e,t){if(typeof t.handler=="function")return s=t.handler(r)}),s},disableElement:function(e){e.data("ujs:enable-with",e.html()),e.html(e.data("disable-with")),e.bind("click.railsDisable",function(e){return n.stopEverything(e)})},enableElement:function(e){e.data("ujs:enable-with")!==t&&(e.html(e.data("ujs:enable-with")),e.data("ujs:enable-with",!1)),e.unbind("click.railsDisable")}},e.ajaxPrefilter(function(e,t,r){e.crossDomain||n.CSRFProtection(r)}),e(document).delegate(n.linkDisableSelector,"ajax:complete",function(){n.enableElement(e(this))}),e(document).delegate(n.linkClickSelector,"click.rails",function(r){var i=e(this),s=i.data("method"),o=i.data("params");if(!n.allowAction(i))return n.stopEverything(r);i.is(n.linkDisableSelector)&&n.disableElement(i);if(i.data("remote")!==t)return(r.metaKey||r.ctrlKey)&&(!s||s==="GET")&&!o?!0:(n.handleRemote(i)===!1&&n.enableElement(i),!1);if(i.data("method"))return n.handleMethod(i),!1}),e(document).delegate(n.inputChangeSelector,"change.rails",function(t){var r=e(this);return n.allowAction(r)?(n.handleRemote(r),!1):n.stopEverything(t)}),e(document).delegate(n.formSubmitSelector,"submit.rails",function(r){var i=e(this),s=i.data("remote")!==t,o=n.blankInputs(i,n.requiredInputSelector),u=n.nonBlankInputs(i,n.fileInputSelector);if(!n.allowAction(i))return n.stopEverything(r);if(o&&i.attr("novalidate")==t&&n.fire(i,"ajax:aborted:required",[o]))return n.stopEverything(r);if(s)return u?n.fire(i,"ajax:aborted:file",[u]):!e.support.submitBubbles&&e().jquery<"1.7"&&n.callFormSubmitBindings(i,r)===!1?n.stopEverything(r):(n.handleRemote(i),!1);setTimeout(function(){n.disableFormElements(i)},13)}),e(document).delegate(n.formInputClickSelector,"click.rails",function(t){var r=e(this);if(!n.allowAction(r))return n.stopEverything(t);var i=r.attr("name"),s=i?{name:i,value:r.val()}:null;r.closest("form").data("ujs:submit-button",s)}),e(document).delegate(n.formSubmitSelector,"ajax:beforeSend.rails",function(t){this==t.target&&n.disableFormElements(e(this))}),e(document).delegate(n.formSubmitSelector,"ajax:complete.rails",function(t){this==t.target&&n.enableFormElements(e(this))})})(jQuery),function(e){e.cookie=function(t,n,r){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(n))||n===null||n===undefined)){r=e.extend({},r);if(n===null||n===undefined)r.expires=-1;if(typeof r.expires=="number"){var i=r.expires,s=r.expires=new Date;s.setDate(s.getDate()+i)}return n=String(n),document.cookie=[encodeURIComponent(t),"=",r.raw?n:encodeURIComponent(n),r.expires?"; expires="+r.expires.toUTCString():"",r.path?"; path="+r.path:"",r.domain?"; domain="+r.domain:"",r.secure?"; secure":""].join("")}r=n||{};var o=r.raw?function(e){return e}:decodeURIComponent,u=document.cookie.split("; ");for(var a=0,f;f=u[a]&&u[a].split("=");a++)if(o(f[0])===t)return o(f[1]||"");return null}}(jQuery),function(e){function r(){var t=new Array;e("a.kudos").each(function(n){s=e(this).closest("article").attr("id"),t.push(s)}),e.post("/posts/kudos",{kudosList:t},function(t){e.each(t,function(t,n){kold=e("#"+n.external_id).find("span.ksum"),knew=n.kudos,knew>0&&(knew=knew.toString(),knew=knew.replace(/\B(?=(\d{3})+(?!\d))/g,","),kold.html(knew))})})}function a(e){e.oldKudoText=e.find("span.ksum").html().replace(/,/g,""),e.children("p.count").hide(),e.append('<p class="count notice"><span class="dont-move">Don\'t move...</span></p>'),e.addClass("filling").removeClass("animate"),e.parent("figure").addClass("filling"),n(function(){l(e)},1e3)}function f(e){n(function(){},1e3),e.hasClass("kudoable")&&(e.removeClass("filling").addClass("animate"),e.parent("figure").removeClass("filling"),e.children("p.count").hide().html(e.oldKudoText),e.children("p.notice").remove(),e.children("p.count").fadeIn("slow"))}function l(t){t.flag=!0,t.article=t.closest("article").attr("id"),e.post("/kudos",{article:t.article,cooking:i}),t.removeClass("animate").removeClass("kudoable").removeClass("filling").addClass("completed"),t.parent("figure").removeClass("filling"),e.cookie(t.article,!0),newnum=parseInt(t.oldKudoText)+1,isNaN(newnum)&&(newnum=1),newnum=newnum.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),t.newtext=newnum+" "+'<span class="identifier">Kudos</span>',t.children("p.notice").hide().remove(),t.children("p.count").html(t.newtext).fadeIn()}var t=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}(),n=function(){var e=0;return function(t,n){clearTimeout(e),e=setTimeout(t,n)}}();buildUser(),r(),e("a.kudos").each(function(t){s=e(this).closest("article").attr("id"),e.cookie(s)&&e(this).removeClass("animate").removeClass("kudoable").addClass("completed")}),e.kudo={},e.kudo.flag=!1,e.kudo.article=!1;var i=1908694305346,s=!1,o=e.user.username,u=!1;e("a.kudos").click(function(e){return e.preventDefault(),!1}),e("a.kudos").mouseenter(function(){u=e(this),u.hasClass("kudoable")&&a(u)}).mouseleave(function(){u=e(this),f(u)}),e("a.kudos").live("touchstart",function(t){u=e(this),u.hasClass("kudoable")&&a(u),t.preventDefault()}),e("a.kudos").live("touchend",function(t){u=e(this),f(u),t.preventDefault()})}(jQuery),$(document).ready(function(){$("div.error_explanation, div#error_explanation").length>0&&flasher(),$("article.preview").length>0&&startPreview(),$("code").length!=0&&startCode()});